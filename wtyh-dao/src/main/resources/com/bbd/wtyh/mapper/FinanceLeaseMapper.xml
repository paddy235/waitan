<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bbd.wtyh.mapper.FinanceLeaseMapper">


    <select id="queryFinanceLeaseStatistic" parameterType="java.util.Map" resultType="com.bbd.wtyh.domain.vo.FinanceLeaseStatisticVO">
		SELECT
			registered_capital_type as registeredCapitalType,
			sum(registered_capital) as registeredCapital,
			COUNT(*) as companyNumber,
			YEAR (registered_date) AS year
		FROM
			company
		WHERE
			registered_capital = 13
			AND registered_date IS NOT NULL
			<if test="year > 0">
				AND YEAR (registered_date) = #{year}
			</if>
			<if test="registeredCapitalType > 0">
				AND registered_capital_type = #{registeredCapitalType}
			</if>
		GROUP BY
			registered_capital_type,
			year
		ORDER BY
			year asc;
	</select>

	<select id="queryFinanceLeaseCompanyCategory" resultType="java.util.Map">
		SELECT
			fle.free_trade_zone as freeTradeZone,
			COUNT(c.company_id) as companyNumber
		FROM
			company c
		LEFT JOIN finance_lease_extra fle ON c.company_id = fle.company_id
		WHERE
			c.company_type = 13
		<if test="year > 0">
			AND YEAR(registered_date) = #{year}
		</if>
		GROUP BY
			fle.free_trade_zone;
	</select>

	<select id="queryLeaseCompanyList" parameterType="java.util.Map" resultType="com.bbd.wtyh.domain.vo.FinanceLeaseVO">
		SELECT
			flr.risk_type as riskType,
			flr.risk_status as riskStatus,
			c.`name` AS company,
			c.address AS address
		FROM
			finance_lease_risk flr
		LEFT JOIN company c ON c.company_id = flr.company_id
		LEFT JOIN area a ON c.area_id = a.area_id
		WHERE
			1 = 1
		AND c.company_type = 13
		<if test="areaId != null and areaId != ''">
			AND a.name = #{areaId}
		</if>
		<if test="areaId == null or areaId == ''">
			AND a.name = '黄浦区'
		</if>
	</select>

</mapper>